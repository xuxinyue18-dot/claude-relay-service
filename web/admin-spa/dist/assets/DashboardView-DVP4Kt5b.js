import{_ as ee}from"./Badge-DRvsZhbG.js";import{E as ae}from"./element-plus-BUfCkBQO.js";import{_ as Jt,c as it,s as Et,a as se}from"./index-CGcTkEyx.js";import{c as qt,x as b,y as k,z as t,L as A,A as It,C as Y,O as P,P as p,aP as oe,r as S,aX as Zt,o as kt,q as ne,D as lt,V as re,R as Z,J as E,u as a,Q as Kt,ac as Ot,K as le,al as ie,B as de}from"./vue-vendor-R8HMg95E.js";import{C as Lt}from"./chart-yFHxLHpB.js";import"./vendor-Dr8jvgFu.js";const ce={class:"stat-card ui-stat-card"},ue={class:"ui-stat-card__row"},me={class:"ui-stat-card__body"},pe={class:"ui-stat-card__title"},ye={key:0,class:"ui-stat-card__value"},ge={key:1,class:"ui-stat-card__extra"},fe={key:2,class:"ui-stat-card__subtitle"},xe={__name:"StatCard",props:{title:{type:String,required:!0},value:{type:[String,Number],default:void 0},subtitle:{type:String,default:""},icon:{type:String,default:""},variant:{type:String,default:"primary"}},setup(z){const J=z,mt=new Set(["primary","secondary","accent","magenta","success","warning","danger","neutral"]),tt=qt(()=>mt.has(J.variant)?J.variant:"primary");return(s,pt)=>(k(),b("div",ce,[t("div",ue,[t("div",me,[t("p",pe,[It(s.$slots,"title",{},()=>[P(p(z.title),1)],!0)]),s.$slots.value||z.value!==void 0?(k(),b("div",ye,[It(s.$slots,"value",{},()=>[P(p(z.value),1)],!0)])):A("",!0),s.$slots.default?(k(),b("div",ge,[It(s.$slots,"default",{},void 0,!0)])):A("",!0),s.$slots.subtitle||z.subtitle?(k(),b("p",fe,[It(s.$slots,"subtitle",{},()=>[P(p(z.subtitle),1)],!0)])):A("",!0)]),s.$slots.icon||z.icon?(k(),b("div",{key:0,class:Y(["stat-icon ui-stat-card__icon",`ui-si--${tt.value}`])},[It(s.$slots,"icon",{},()=>[t("i",{class:Y(["ui-stat-card__icon-i",z.icon])},null,2)],!0)],2)):A("",!0)])]))}},ve=Jt(xe,[["__scopeId","data-v-e39333e6"]]),he=oe("dashboard",()=>{const z=S(!1),J=S({totalApiKeys:0,activeApiKeys:0,totalAccounts:0,normalAccounts:0,abnormalAccounts:0,pausedAccounts:0,activeAccounts:0,rateLimitedAccounts:0,accountsByPlatform:{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:0,totalRequests:0,todayTokens:0,todayInputTokens:0,todayOutputTokens:0,totalTokens:0,totalInputTokens:0,totalOutputTokens:0,totalCacheCreateTokens:0,totalCacheReadTokens:0,todayCacheCreateTokens:0,todayCacheReadTokens:0,systemRPM:0,systemTPM:0,realtimeRPM:0,realtimeTPM:0,metricsWindow:5,isHistoricalMetrics:!1,systemStatus:"æ­£å¸¸",uptime:0,systemTimezone:8}),mt=S({todayCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}}}),tt=S([]),s=S([]),pt=S([]),et=S({data:[],topApiKeys:[],totalApiKeys:0}),_t=S({data:[],topAccounts:[],totalAccounts:0,group:"claude",groupLabel:"Claudeè´¦æˆ·"}),O={preset:"dashboard:date:preset",granularity:"dashboard:trend:granularity"},M="today",wt="day",yt=d=>d==="hour"?[{value:"last24h",label:"è¿‘24å°æ—¶",hours:24},{value:"yesterday",label:"æ˜¨å¤©",hours:24},{value:"dayBefore",label:"å‰å¤©",hours:24}]:[{value:"today",label:"ä»Šæ—¥",days:1},{value:"7days",label:"7å¤©",days:7},{value:"30days",label:"30å¤©",days:30}],at=(d,x)=>{try{return localStorage.getItem(d)||x}catch{return x}},Q=(d,x)=>{try{localStorage.setItem(d,x)}catch{}},H=(d,x)=>yt(x).some(v=>v.value===d)?d:x==="hour"?"last24h":M,Ut=at(O.granularity,wt),Ct=["day","hour"].includes(Ut)?Ut:wt,zt=H(at(O.preset,M),Ct),o=S({type:"preset",preset:zt,customStart:"",customEnd:"",customRange:null,presetOptions:yt(Ct)}),F=S(Ct),Dt=S("requests"),gt=S("claude"),Gt=S([new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)]),Ht=qt(()=>{const d=J.value.uptime,x=Math.floor(d/86400),m=Math.floor(d%86400/3600),r=Math.floor(d%3600/60);return x>0?`${x}å¤© ${m}å°æ—¶`:m>0?`${m}å°æ—¶ ${r}åˆ†é’Ÿ`:`${r}åˆ†é’Ÿ`});function _(d,x=!0){const m=d.getFullYear(),r=d.getMonth(),v=d.getDate();return x?new Date(Date.UTC(m,r,v-1,16,0,0,0)):new Date(Date.UTC(m,r,v,15,59,59,999))}const st=(d=o.value.preset,x=F.value)=>{Q(O.preset,d),Q(O.granularity,x)},W=()=>o.value.type==="preset"&&o.value.preset==="today"&&F.value==="day"?"hour":F.value;async function Tt(d=null){z.value=!0;try{let x={today:"today",all:"all"};d&&(x={today:{today:"today",all:"today"},"7days":{today:"7days",all:"7days"},monthly:{today:"monthly",all:"monthly"},all:{today:"today",all:"all"}}[d]||x);const[m,r,v]=await Promise.all([it.get("/admin/dashboard"),it.get(`/admin/usage-costs?period=${x.today}`),it.get(`/admin/usage-costs?period=${x.all}`)]);if(m.success){const n=m.data.overview||{},l=m.data.recentActivity||{},i=m.data.systemAverages||{},y=m.data.realtimeMetrics||{},c=m.data.systemHealth||{};J.value={totalApiKeys:n.totalApiKeys||0,activeApiKeys:n.activeApiKeys||0,totalAccounts:n.totalAccounts||n.totalClaudeAccounts||0,normalAccounts:n.normalAccounts||0,abnormalAccounts:n.abnormalAccounts||0,pausedAccounts:n.pausedAccounts||0,activeAccounts:n.activeAccounts||n.activeClaudeAccounts||0,rateLimitedAccounts:n.rateLimitedAccounts||n.rateLimitedClaudeAccounts||0,accountsByPlatform:n.accountsByPlatform||{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:l.requestsToday||0,totalRequests:n.totalRequestsUsed||0,todayTokens:l.tokensToday||0,todayInputTokens:l.inputTokensToday||0,todayOutputTokens:l.outputTokensToday||0,totalTokens:n.totalTokensUsed||0,totalInputTokens:n.totalInputTokensUsed||0,totalOutputTokens:n.totalOutputTokensUsed||0,totalCacheCreateTokens:n.totalCacheCreateTokensUsed||0,totalCacheReadTokens:n.totalCacheReadTokensUsed||0,todayCacheCreateTokens:l.cacheCreateTokensToday||0,todayCacheReadTokens:l.cacheReadTokensToday||0,systemRPM:i.rpm||0,systemTPM:i.tpm||0,realtimeRPM:y.rpm||0,realtimeTPM:y.tpm||0,metricsWindow:y.windowMinutes||5,isHistoricalMetrics:y.isHistorical||!1,systemStatus:c.redisConnected?"æ­£å¸¸":"å¼‚å¸¸",uptime:c.uptime||0,systemTimezone:m.data.systemTimezone||8}}r.success&&v.success&&(mt.value={todayCosts:r.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:v.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}}})}catch(x){console.error("åŠ è½½ä»ªè¡¨æ¿æ•°æ®å¤±è´¥:",x)}finally{z.value=!1}}async function ot(d=7,x=W()){try{let m="/admin/usage-trend?";if(x==="hour")if(m+="granularity=hour",o.value.customRange&&o.value.customRange.length===2)m+=`&startDate=${encodeURIComponent(o.value.customRange[0])}`,m+=`&endDate=${encodeURIComponent(o.value.customRange[1])}`;else{const v=new Date;let n,l;if(o.value.type==="preset")switch(o.value.preset){case"today":{n=_(v,!0),l=_(v,!1);break}case"last24h":{l=new Date(v),n=new Date(v.getTime()-24*60*60*1e3);break}case"yesterday":{const i=new Date;i.setDate(i.getDate()-1),n=_(i,!0),l=_(i,!1);break}case"dayBefore":{const i=new Date;i.setDate(i.getDate()-2),n=_(i,!0),l=_(i,!1);break}default:n=new Date(v.getTime()-24*60*60*1e3),l=v}else n=new Date(v.getTime()-d*24*60*60*1e3),l=v;m+=`&startDate=${encodeURIComponent(n.toISOString())}`,m+=`&endDate=${encodeURIComponent(l.toISOString())}`}else m+=`granularity=day&days=${d}`;const r=await it.get(m);r.success&&(s.value=r.data)}catch(m){console.error("åŠ è½½ä½¿ç”¨è¶‹åŠ¿å¤±è´¥:",m)}}async function nt(d="daily",x=null){const m=x||W();try{let r=`/admin/model-stats?period=${d}`;if(o.value.type==="custom"||m==="hour"){if(o.value.customRange&&o.value.customRange.length===2)r+=`&startDate=${encodeURIComponent(o.value.customRange[0])}`,r+=`&endDate=${encodeURIComponent(o.value.customRange[1])}`;else if(m==="hour"&&o.value.type==="preset"){const n=new Date;let l,i;switch(o.value.preset){case"today":{l=_(n,!0),i=_(n,!1);break}case"last24h":{i=new Date(n),l=new Date(n.getTime()-24*60*60*1e3);break}case"yesterday":{const y=new Date;y.setDate(y.getDate()-1),l=_(y,!0),i=_(y,!1);break}case"dayBefore":{const y=new Date;y.setDate(y.getDate()-2),l=_(y,!0),i=_(y,!1);break}default:l=new Date(n.getTime()-24*60*60*1e3),i=n}r+=`&startDate=${encodeURIComponent(l.toISOString())}`,r+=`&endDate=${encodeURIComponent(i.toISOString())}`}}else if(o.value.type==="preset"&&m==="day"){const n=new Date;let l,i;const y=o.value.presetOptions.find(c=>c.value===o.value.preset);if(y){if(o.value.preset==="today")l=_(n,!0),i=_(n,!1);else{const c=new Date;c.setDate(c.getDate()-(y.days-1)),l=_(c,!0),i=_(n,!1)}r+=`&startDate=${encodeURIComponent(l.toISOString())}`,r+=`&endDate=${encodeURIComponent(i.toISOString())}`}}const v=await it.get(r);v.success&&(pt.value=v.data)}catch(r){console.error("åŠ è½½æ¨¡å‹ç»Ÿè®¡å¤±è´¥:",r)}}async function rt(d="requests",x=null){const m=x||W();try{let r="/admin/api-keys-usage-trend?",v=7;if(m==="hour")if(r+="granularity=hour",o.value.customRange&&o.value.customRange.length===2)r+=`&startDate=${encodeURIComponent(o.value.customRange[0])}`,r+=`&endDate=${encodeURIComponent(o.value.customRange[1])}`;else{const l=new Date;let i,y;if(o.value.type==="preset")switch(o.value.preset){case"today":{i=_(l,!0),y=_(l,!1);break}case"last24h":{y=new Date(l),i=new Date(l.getTime()-24*60*60*1e3);break}case"yesterday":{const c=new Date;c.setDate(c.getDate()-1),i=_(c,!0),y=_(c,!1);break}case"dayBefore":{const c=new Date;c.setDate(c.getDate()-2),i=_(c,!0),y=_(c,!1);break}default:i=new Date(l.getTime()-24*60*60*1e3),y=l}else i=new Date(l.getTime()-24*60*60*1e3),y=l;r+=`&startDate=${encodeURIComponent(i.toISOString())}`,r+=`&endDate=${encodeURIComponent(y.toISOString())}`}else v=o.value.type==="preset"?o.value.preset==="today"?1:o.value.preset==="7days"?7:30:St(o.value.customStart,o.value.customEnd),r+=`granularity=day&days=${v}`;r+=`&metric=${d}`;const n=await it.get(r);n.success&&(et.value={data:n.data||[],topApiKeys:n.topApiKeys||[],totalApiKeys:n.totalApiKeys||0})}catch(r){console.error("åŠ è½½API Keysè¶‹åŠ¿å¤±è´¥:",r)}}async function X(d=gt.value,x=null){const m=x||W();try{let r="/admin/account-usage-trend?",v=7;if(m==="hour")if(r+="granularity=hour",o.value.customRange&&o.value.customRange.length===2)r+=`&startDate=${encodeURIComponent(o.value.customRange[0])}`,r+=`&endDate=${encodeURIComponent(o.value.customRange[1])}`;else{const l=new Date;let i,y;if(o.value.type==="preset")switch(o.value.preset){case"today":{i=_(l,!0),y=_(l,!1);break}case"last24h":{y=new Date(l),i=new Date(l.getTime()-24*60*60*1e3);break}case"yesterday":{const c=new Date;c.setDate(c.getDate()-1),i=_(c,!0),y=_(c,!1);break}case"dayBefore":{const c=new Date;c.setDate(c.getDate()-2),i=_(c,!0),y=_(c,!1);break}default:i=new Date(l.getTime()-24*60*60*1e3),y=l}else i=new Date(l.getTime()-24*60*60*1e3),y=l;r+=`&startDate=${encodeURIComponent(i.toISOString())}`,r+=`&endDate=${encodeURIComponent(y.toISOString())}`}else v=o.value.type==="preset"?o.value.preset==="today"?1:o.value.preset==="7days"?7:30:St(o.value.customStart,o.value.customEnd),r+=`granularity=day&days=${v}`;r+=`&group=${d}`;const n=await it.get(r);n.success&&(_t.value={data:n.data||[],topAccounts:n.topAccounts||[],totalAccounts:n.totalAccounts||0,group:n.group||d,groupLabel:n.groupLabel||""})}catch(r){console.error("åŠ è½½è´¦å·ä½¿ç”¨è¶‹åŠ¿å¤±è´¥:",r)}}function dt(d,x={}){const{silent:m=!1,skipSave:r=!1}=x,v=H(d,F.value);o.value.type="preset",o.value.preset=v;const n=o.value.presetOptions.find(D=>D.value===v),l=new Date;let i,y;if(F.value==="hour")switch(v){case"today":{i=_(l,!0),y=_(l,!1);break}case"last24h":{y=new Date(l),i=new Date(l.getTime()-24*60*60*1e3);break}case"yesterday":{const D=new Date;D.setDate(D.getDate()-1),i=_(D,!0),y=_(D,!1);break}case"dayBefore":{const D=new Date;D.setDate(D.getDate()-2),i=_(D,!0),y=_(D,!1);break}default:y=new Date(l),i=new Date(l.getTime()-24*60*60*1e3)}else i=new Date(l),y=new Date(l),v==="today"?(i.setHours(0,0,0,0),y.setHours(23,59,59,999)):n!=null&&n.days&&(i.setDate(l.getDate()-(n.days-1)),i.setHours(0,0,0,0),y.setHours(23,59,59,999));const c=D=>{const j=new Date(D),ft=j.getFullYear(),Rt=String(j.getMonth()+1).padStart(2,"0"),Pt=String(j.getDate()).padStart(2,"0"),xt=String(j.getHours()).padStart(2,"0"),Ft=String(j.getMinutes()).padStart(2,"0"),vt=String(j.getSeconds()).padStart(2,"0");return`${ft}-${Rt}-${Pt} ${xt}:${Ft}:${vt}`};o.value.customStart=i?i.toISOString().split("T")[0]:"",o.value.customEnd=y?y.toISOString().split("T")[0]:"",o.value.customRange=i&&y?[c(i),c(y)]:null,r||st(o.value.preset,F.value),m||V()}function $t(d){if(d&&d.length===2){o.value.type="custom",o.value.preset="",o.value.customRange=d,o.value.customStart=d[0].split(" ")[0],o.value.customEnd=d[1].split(" ")[0];const x=v=>{const[n,l]=v.split(" "),[i,y,c]=n.split("-").map(Number),[D,j,ft]=l.split(":").map(Number);return new Date(i,y-1,c,D,j,ft)},m=x(d[0]),r=x(d[1]);if(F.value==="hour"){if((r-m)/36e5>24){Et("å°æ—¶ç²’åº¦ä¸‹æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡24å°æ—¶","warning");return}}else if(Math.ceil((r-m)/864e5)+1>31){Et("æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡ 31 å¤©","warning");return}V()}else d===null&&dt(F.value==="hour"?"last24h":M)}function ct(d,x={}){const{silent:m=!1,skipSave:r=!1,presetOverride:v}=x;if(F.value=d,d==="hour"){if(o.value.presetOptions=yt("hour"),o.value.type==="custom"&&o.value.customRange&&o.value.customRange.length===2){const l=new Date(o.value.customRange[0]);if((new Date(o.value.customRange[1])-l)/(1e3*60*60)>24){Et("å°æ—¶ç²’åº¦ä¸‹æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡24å°æ—¶ï¼Œå·²åˆ‡æ¢åˆ°è¿‘24å°æ—¶","warning"),dt("last24h",{silent:m,skipSave:r});return}}}else o.value.presetOptions=yt("day");if(o.value.type==="custom"){r||st(o.value.preset||M,F.value),m||V();return}const n=v||H(o.value.preset,F.value);dt(n,{silent:!0,skipSave:!0}),r||st(o.value.preset,F.value),m||V()}async function V(){let d,x="monthly";const m=W();if(o.value.type==="preset"){const r=o.value.presetOptions.find(v=>v.value===o.value.preset);m==="hour"?(d=1,x="daily"):(d=r?r.days:7,o.value.preset==="today"?x="daily":x="monthly")}else{if(m==="hour"){const r=new Date(o.value.customRange[0]),v=new Date(o.value.customRange[1]),n=Math.ceil((v-r)/(1e3*60*60));d=Math.ceil(n/24)||1}else d=St(o.value.customStart,o.value.customEnd);x="daily"}await Promise.all([ot(d,m),nt(x,m),rt(Dt.value,m),X(gt.value,m)])}function Mt(d){return gt.value=d,X(d,W())}function St(d,x){if(!d||!x)return 7;const m=new Date(d),r=new Date(x),v=Math.abs(r-m);return Math.ceil(v/(1e3*60*60*24))||7}function At(d){return d>new Date}return dt(o.value.preset,{silent:!0,skipSave:!0}),st(o.value.preset,F.value),{loading:z,dashboardData:J,costsData:mt,modelStats:tt,trendData:s,dashboardModelStats:pt,apiKeysTrendData:et,accountUsageTrendData:_t,dateFilter:o,trendGranularity:F,apiKeysTrendMetric:Dt,accountUsageGroup:gt,defaultTime:Gt,formattedUptime:Ht,loadDashboardData:Tt,loadUsageTrend:ot,loadModelStats:nt,loadApiKeysTrend:rt,loadAccountUsageTrend:X,setDateFilterPreset:dt,onCustomDateRangeChange:$t,setTrendGranularity:ct,refreshChartsData:V,setAccountUsageGroup:Mt,disabledDate:At}}),be={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},ke={class:"flex flex-wrap items-baseline gap-x-2"},_e={key:0,class:"flex items-center gap-2"},we=["title"],Ce={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},De=["title"],Te={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},$e=["title"],Se={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ae=["title"],Re={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Pe=["title"],Be={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ie=["title"],Ue={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Me=["title"],Fe={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ke={key:0,class:"text-red-600"},Oe={key:1,class:"text-gray-600 dark:text-gray-400"},Le={key:2,class:"text-yellow-600"},Ee={class:"text-green-600"},qe={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6"},ze={class:"stat-card"},Ge={class:"flex items-center justify-between"},He={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},Ne={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ve={class:"mt-3 flex items-center justify-between gap-3"},je={class:"text-xs text-gray-500 dark:text-gray-400"},Ye=["disabled"],We={class:"card p-4 sm:p-6"},Ze={class:"mb-3 flex items-center justify-between"},Je={class:"text-xs text-gray-500 dark:text-gray-400"},Qe={key:0,class:"py-6 text-center text-sm text-gray-500 dark:text-gray-400"},Xe={key:1,class:"py-6 text-center text-sm text-green-600 dark:text-green-400"},ta={key:2,class:"max-h-64 space-y-2 overflow-y-auto"},ea={class:"flex items-center justify-between gap-2"},aa={class:"truncate text-sm font-medium text-gray-900 dark:text-gray-100"},sa={class:"rounded bg-gray-100 px-2 py-0.5 text-xs text-gray-600 dark:bg-gray-700 dark:text-gray-300"},oa={class:"mt-1 text-xs text-gray-600 dark:text-gray-400"},na={key:0},ra={key:1},la={key:0,class:"mt-2"},ia={class:"mb-1 flex items-center justify-between text-xs text-gray-600 dark:text-gray-400"},da={class:"text-red-600 dark:text-red-400"},ca={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},ua={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},ma={class:"flex flex-wrap items-baseline gap-2"},pa={class:"text-sm font-medium text-green-600"},ya={class:"text-xs text-gray-500 dark:text-gray-400"},ga={class:"flex flex-wrap items-center justify-between gap-x-4"},fa={class:"font-medium"},xa={class:"font-medium"},va={key:0,class:"text-magenta-600"},ha={class:"font-medium"},ba={key:1,class:"text-magenta-600"},ka={class:"font-medium"},_a={class:"flex flex-wrap items-baseline gap-2"},wa={class:"text-emerald-600"},Ca={class:"text-sm font-medium text-green-600"},Da={class:"text-xs text-gray-500 dark:text-gray-400"},Ta={class:"flex flex-wrap items-center justify-between gap-x-4"},$a={class:"font-medium"},Sa={class:"font-medium"},Aa={key:0,class:"text-magenta-600"},Ra={class:"font-medium"},Pa={key:1,class:"text-magenta-600"},Ba={class:"font-medium"},Ia={class:"text-orange-600"},Ua={key:0,class:"text-yellow-600"},Ma={class:"text-rose-600"},Fa={key:0,class:"text-yellow-600"},Ka={class:"mb-8"},Oa={class:"mb-4 flex flex-col gap-4 sm:mb-6"},La={class:"flex flex-col gap-2 lg:flex-row lg:items-center lg:justify-end"},Ea={class:"flex flex-shrink-0 gap-1 overflow-x-auto rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},qa=["onClick"],za={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},Ga={class:"flex items-center gap-2"},Ha={key:0,class:"text-xs text-orange-600"},Na={class:"flex items-center gap-2"},Va={class:"flex items-center rounded-lg bg-gray-100 px-3 py-1 dark:bg-gray-700"},ja={class:"relative inline-flex cursor-pointer items-center"},Ya={class:"ml-2.5 flex select-none items-center gap-1 text-sm font-medium text-gray-600 dark:text-gray-300"},Wa=["disabled"],Za={class:"hidden sm:inline"},Ja={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Qa={class:"card p-4 sm:p-6"},Xa={class:"relative",style:{height:"250px"}},ts={class:"card p-4 sm:p-6"},es={key:0,class:"py-8 text-center"},as={key:1,class:"max-h-[250px] overflow-auto sm:max-h-[300px]"},ss={class:"min-w-full"},os={class:"divide-y divide-gray-200 dark:divide-gray-600"},ns={class:"px-2 py-2 text-xs text-gray-900 dark:text-gray-100 sm:px-4 sm:text-sm"},rs=["title"],ls={class:"hidden px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:table-cell sm:px-4 sm:text-sm"},is={class:"px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:px-4 sm:text-sm"},ds={class:"px-2 py-2 text-right text-xs font-medium text-green-600 sm:px-4 sm:text-sm"},cs={class:"hidden px-2 py-2 text-right text-xs font-medium sm:table-cell sm:px-4 sm:text-sm"},us={class:"mb-4 sm:mb-6 md:mb-8"},ms={class:"card p-4 sm:p-6"},ps={class:"sm:h-[300px]",style:{height:"250px"}},ys={class:"mb-4 sm:mb-6 md:mb-8"},gs={class:"card p-4 sm:p-6"},fs={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},xs={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},vs={class:"mb-4 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},hs={key:0},bs={key:1},ks={class:"sm:h-[350px]",style:{height:"300px"}},_s={class:"mb-4 sm:mb-6 md:mb-8"},ws={class:"card p-4 sm:p-6"},Cs={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Ds={class:"flex flex-col gap-1 sm:flex-row sm:items-center sm:gap-3"},Ts={class:"text-xs text-gray-500 dark:text-gray-400 sm:text-sm"},$s={class:"flex flex-wrap items-center gap-2"},Ss={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},As=["onClick"],Rs={class:"mb-4 flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},Ps={key:0},Bs={key:0,class:"py-12 text-center text-sm text-gray-500 dark:text-gray-400"},Is={key:1,class:"sm:h-[350px]",style:{height:"300px"}},Us={__name:"DashboardView",setup(z){const J=he(),mt=se(),{isDarkMode:tt}=Zt(mt),{dashboardData:s,costsData:pt,dashboardModelStats:et,trendData:_t,apiKeysTrendData:O,accountUsageTrendData:M,accountUsageGroup:wt,formattedUptime:yt,dateFilter:at,trendGranularity:Q,apiKeysTrendMetric:H,defaultTime:Ut}=Zt(J),{loadDashboardData:Ct,loadApiKeysTrend:zt,setDateFilterPreset:o,onCustomDateRangeChange:F,setTrendGranularity:Dt,refreshChartsData:gt,setAccountUsageGroup:Gt,disabledDate:Ht}=J,_=S(null),st=S(null),W=S(null),Tt=S(null);let ot=null,nt=null,rt=null,X=null;const dt=[{value:"claude",label:"Claude"},{value:"openai",label:"OpenAI"},{value:"gemini",label:"Gemini"},{value:"droid",label:"Droid"}],$t=S(!1),ct=S({totalBalance:0,totalCost:0,lowBalanceCount:0,platforms:{}}),V=S(!1),Mt=S(null),St=u=>({claude:"Claude","claude-console":"Claude Console",gemini:"Gemini","gemini-api":"Gemini API",openai:"OpenAI","openai-responses":"OpenAI Responses",azure_openai:"Azure OpenAI",bedrock:"Bedrock",droid:"Droid",ccr:"CCR"})[u]||u,At=qt(()=>{var C;const u=[],e=((C=ct.value)==null?void 0:C.platforms)||{};return Object.entries(e).forEach(([G,K])=>{(Array.isArray(K==null?void 0:K.accounts)?K.accounts:[]).forEach(I=>{var T,w;const q=I==null?void 0:I.data;if(!q)return;const $=(T=q.balance)==null?void 0:T.amount,B=(w=q.quota)==null?void 0:w.percentage,h=typeof $=="number"&&$<10,g=typeof B=="number"&&B>90;(h||g)&&u.push({...q,name:(I==null?void 0:I.name)||q.accountId,platform:q.platform||G})})}),u}),d=u=>{const e=Number(u);return Number.isFinite(e)?e>=1?`$${e.toFixed(2)}`:e>=.01?`$${e.toFixed(3)}`:`$${e.toFixed(6)}`:"$0.00"},x=u=>{if(!u)return"æœªçŸ¥";const e=new Date(u);return Number.isNaN(e.getTime())?"æœªçŸ¥":e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},m=async()=>{V.value=!0;try{const u=await it.get("/admin/accounts/balance/summary");u!=null&&u.success&&(ct.value=u.data||{totalBalance:0,totalCost:0,lowBalanceCount:0,platforms:{}},Mt.value=new Date().toISOString())}catch(u){console.debug("åŠ è½½ä½™é¢æ±‡æ€»å¤±è´¥:",u),Et("åŠ è½½ä½™é¢æ±‡æ€»å¤±è´¥","error")}finally{V.value=!1}},r=S(!1),v=S(30),n=S(null),l=S(0),i=S(null),y=S(!1),c=qt(()=>({text:tt.value?"#e5e7eb":"#374151",grid:tt.value?"rgba(75, 85, 99, 0.3)":"rgba(0, 0, 0, 0.1)",legend:tt.value?"#e5e7eb":"#374151"}));function D(u){return u>=1e6?(u/1e6).toFixed(2)+"M":u>=1e3?(u/1e3).toFixed(2)+"K":u.toString()}function j(u){return Number.isFinite(u)?u>=1?`$${u.toFixed(2)}`:u>=.01?`$${u.toFixed(3)}`:`$${u.toFixed(6)}`:"$0.000000"}function ft(u,e){if(!e||e.length===0)return 0;const C=e.reduce((G,K)=>G+K.allTokens,0);return C===0?0:(u/C*100).toFixed(1)}function Rt(){if(!_.value)return;ot&&ot.destroy();const u=et.value||[],e={labels:u.map(C=>C.model),datasets:[{data:u.map(C=>C.allTokens),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],borderWidth:0}]};ot=new Lt(_.value,{type:"doughnut",data:e,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,usePointStyle:!0,font:{size:12},color:c.value.legend}},tooltip:{callbacks:{label:function(C){const G=C.label||"",K=D(C.parsed),f=ft(C.parsed,u);return`${G}: ${K} (${f}%)`}}}}}})}function Pt(){var h;if(!st.value)return;nt&&nt.destroy();const u=_t.value||[],e=u.map(g=>g.inputTokens||0),C=u.map(g=>g.outputTokens||0),G=u.map(g=>g.cacheCreateTokens||0),K=u.map(g=>g.cacheReadTokens||0),f=u.map(g=>g.requests||0),I=u.map(g=>g.cost||0),q=(h=u[0])!=null&&h.date?"date":"hour",B={labels:u.map(g=>{if(g.label)return g.label;if(q==="hour"){const w=new Date(g.hour),R=String(w.getMonth()+1).padStart(2,"0"),N=String(w.getDate()).padStart(2,"0"),L=String(w.getHours()).padStart(2,"0");return`${R}/${N} ${L}:00`}const T=g.date;if(T&&T.includes("-")){const w=T.split("-");if(w.length>=3)return`${w[1]}/${w[2]}`}return g.date}),datasets:[{label:"è¾“å…¥Token",data:e,borderColor:"rgb(0, 229, 255)",backgroundColor:"rgba(0, 229, 255, 0.12)",tension:.3},{label:"è¾“å‡ºToken",data:C,borderColor:"rgb(255, 43, 214)",backgroundColor:"rgba(255, 43, 214, 0.12)",tension:.3},{label:"ç¼“å­˜åˆ›å»ºToken",data:G,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3},{label:"ç¼“å­˜è¯»å–Token",data:K,borderColor:"rgb(147, 51, 234)",backgroundColor:"rgba(147, 51, 234, 0.1)",tension:.3},{label:"è´¹ç”¨ (USD)",data:I,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.3,yAxisID:"y2"},{label:"è¯·æ±‚æ•°",data:f,borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.3,yAxisID:"y1"}]};nt=new Lt(st.value,{type:"line",data:B,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{title:{display:!0,text:"Tokenä½¿ç”¨è¶‹åŠ¿",font:{size:16,weight:"bold"},color:c.value.text},legend:{position:"top",labels:{color:c.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:function(g,T){const w=g.dataset.label||"",R=T.dataset.label||"";return w==="è´¹ç”¨ (USD)"||R==="è´¹ç”¨ (USD)"?w==="è´¹ç”¨ (USD)"?-1:1:w==="è¯·æ±‚æ•°"||R==="è¯·æ±‚æ•°"?w==="è¯·æ±‚æ•°"?1:-1:T.parsed.y-g.parsed.y},callbacks:{label:function(g){const T=g.dataset.label||"";let w=g.parsed.y;return T==="è´¹ç”¨ (USD)"?w<.01?T+": $"+w.toFixed(6):T+": $"+w.toFixed(4):T==="è¯·æ±‚æ•°"?T+": "+w.toLocaleString()+" æ¬¡":w>=1e6?T+": "+(w/1e6).toFixed(2)+"M tokens":w>=1e3?T+": "+(w/1e3).toFixed(2)+"K tokens":T+": "+w.toLocaleString()+" tokens"}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:Q==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:c.value.text},ticks:{color:c.value.text},grid:{color:c.value.grid}},y:{type:"linear",display:!0,position:"left",min:0,title:{display:!0,text:"Tokenæ•°é‡",color:c.value.text},ticks:{callback:function(g){return D(g)},color:c.value.text},grid:{color:c.value.grid}},y1:{type:"linear",display:!0,position:"right",min:0,title:{display:!0,text:"è¯·æ±‚æ•°",color:c.value.text},grid:{drawOnChartArea:!1},ticks:{callback:function(g){return g.toLocaleString()},color:c.value.text}},y2:{type:"linear",display:!1,position:"right",min:0}}}})}function xt(){var I,q;if(!W.value)return;rt&&rt.destroy();const u=O.value.data||[],e=H.value,C=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],G=((I=O.value.topApiKeys)==null?void 0:I.map(($,B)=>{var T,w;const h=O.value.data.map(R=>!R.apiKeys||!R.apiKeys[$]?0:e==="tokens"?R.apiKeys[$].tokens:R.apiKeys[$].requests||0);return{label:((w=(T=O.value.data.find(R=>R.apiKeys&&R.apiKeys[$]))==null?void 0:T.apiKeys[$])==null?void 0:w.name)||`API Key ${$}`,data:h,borderColor:C[B%C.length],backgroundColor:C[B%C.length]+"20",tension:.4,fill:!1}}))||[],K=(q=u[0])!=null&&q.date?"date":"hour",f={labels:u.map($=>{if($.label)return $.label;if(K==="hour"){const h=new Date($.hour),g=String(h.getMonth()+1).padStart(2,"0"),T=String(h.getDate()).padStart(2,"0"),w=String(h.getHours()).padStart(2,"0");return`${g}/${T} ${w}:00`}const B=$.date;if(B&&B.includes("-")){const h=B.split("-");if(h.length>=3)return`${h[1]}/${h[2]}`}return $.date}),datasets:G};rt=new Lt(W.value,{type:"line",data:f,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:12},color:c.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:function($,B){return B.parsed.y-$.parsed.y},callbacks:{label:function($){var L;const B=$.dataset.label||"",h=$.parsed.y,g=$.dataIndex,T=O.value.data[g],R=$.chart.data.datasets.map((U,ht)=>({value:U.data[g]||0,index:ht})).sort((U,ht)=>ht.value-U.value).findIndex(U=>U.index===$.datasetIndex)+1;let N="";if(R===1?N="ğŸ¥‡ ":R===2?N="ğŸ¥ˆ ":R===3&&(N="ğŸ¥‰ "),H.value==="tokens"){let U="";h>=1e6?U=(h/1e6).toFixed(2)+"M":h>=1e3?U=(h/1e3).toFixed(2)+"K":U=h.toLocaleString();const ht=O.value.topApiKeys[$.datasetIndex],ut=(L=T==null?void 0:T.apiKeys)==null?void 0:L[ht],bt=(ut==null?void 0:ut.formattedCost)||"$0.00";return`${N}${B}: ${U} tokens (${bt})`}else return`${N}${B}: ${h.toLocaleString()} æ¬¡`}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:Q==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:c.value.text},ticks:{color:c.value.text},grid:{color:c.value.grid}},y:{beginAtZero:!0,min:0,title:{display:!0,text:H.value==="tokens"?"Token æ•°é‡":"è¯·æ±‚æ¬¡æ•°",color:c.value.text},ticks:{callback:function($){return D($)},color:c.value.text},grid:{color:c.value.grid}}}}})}async function Ft(){await zt(H.value),await lt(),xt()}function vt(){var q,$,B;if(!Tt.value)return;X&&X.destroy();const u=((q=M.value)==null?void 0:q.data)||[],e=(($=M.value)==null?void 0:$.topAccounts)||[],C=["#2563EB","#059669","#D97706","#DC2626","#7C3AED","#F472B6","#0EA5E9","#F97316","#6366F1","#22C55E"],G=e.map((h,g)=>{var R,N;const T=u.map(L=>!L.accounts||!L.accounts[h]?0:L.accounts[h].cost||0);return{label:((N=(R=u.find(L=>L.accounts&&L.accounts[h]))==null?void 0:R.accounts[h])==null?void 0:N.name)||`è´¦å· ${String(h).slice(0,6)}`,data:T,borderColor:C[g%C.length],backgroundColor:C[g%C.length]+"20",tension:.4,fill:!1}}),K=(B=u[0])!=null&&B.date?"date":"hour",f={labels:u.map(h=>{if(h.label)return h.label;if(K==="hour"){const g=new Date(h.hour),T=String(g.getMonth()+1).padStart(2,"0"),w=String(g.getDate()).padStart(2,"0"),R=String(g.getHours()).padStart(2,"0");return`${T}/${w} ${R}:00`}if(h.date&&h.date.includes("-")){const g=h.date.split("-");if(g.length>=3)return`${g[1]}/${g[2]}`}return h.date}),datasets:G},I=e;X=new Lt(Tt.value,{type:"line",data:f,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:12},color:c.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:(h,g)=>g.parsed.y-h.parsed.y,callbacks:{label:function(h){var Wt;const g=h.dataset.label||"",T=h.parsed.y||0,w=h.dataIndex,R=h.datasetIndex,N=I[R],L=M.value.data[w],U=(Wt=L==null?void 0:L.accounts)==null?void 0:Wt[N],ut=h.chart.data.datasets.map((Bt,Vt)=>({value:Bt.data[w]||0,index:Vt})).sort((Bt,Vt)=>Vt.value-Bt.value).findIndex(Bt=>Bt.index===R)+1;let bt="";ut===1?bt="ğŸ¥‡ ":ut===2?bt="ğŸ¥ˆ ":ut===3&&(bt="ğŸ¥‰ ");const Xt=(U==null?void 0:U.formattedCost)||j(T),te=(U==null?void 0:U.requests)||0;return`${bt}${g}: ${Xt} / ${te.toLocaleString()} æ¬¡`}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:Q.value==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:c.value.text},ticks:{color:c.value.text},grid:{color:c.value.grid}},y:{beginAtZero:!0,min:0,title:{display:!0,text:"æ¶ˆè€—é‡‘é¢ (USD)",color:c.value.text},ticks:{callback:h=>j(Number(h)),color:c.value.text},grid:{color:c.value.grid}}}}})}async function Qt(u){if(!(wt.value===u||$t.value)){$t.value=!0;try{await Gt(u),await lt(),vt()}finally{$t.value=!1}}}kt(et,()=>{lt(()=>Rt())}),kt(_t,()=>{lt(()=>Pt())}),kt(O,()=>{lt(()=>xt())}),kt(M,()=>{lt(()=>vt())});async function Nt(){if(!y.value){y.value=!0;try{await Promise.all([Ct(),gt(),m()])}finally{y.value=!1}}}function jt(){r.value&&(l.value=v.value,i.value&&clearInterval(i.value),n.value&&clearTimeout(n.value),i.value=setInterval(()=>{l.value--,l.value<=0&&clearInterval(i.value)},1e3),n.value=setTimeout(async()=>{await Nt(),r.value&&jt()},v.value*1e3))}function Yt(){i.value&&(clearInterval(i.value),i.value=null),n.value&&(clearTimeout(n.value),n.value=null),l.value=0}return kt(r,u=>{u?jt():Yt()}),kt(tt,()=>{lt(()=>{Rt(),Pt(),xt(),vt()})}),ne(async()=>{await Nt(),await lt(),Rt(),Pt(),xt(),vt()}),re(()=>{Yt(),ot&&ot.destroy(),nt&&nt.destroy(),rt&&rt.destroy(),X&&X.destroy()}),(u,e)=>{const C=ve,G=ae,K=ee;return k(),b("div",null,[t("div",be,[Z(C,{icon:"fas fa-key",subtitle:"",title:"æ€»API Keys",value:a(s).totalApiKeys,variant:"primary"},{subtitle:E(()=>[P("æ´»è·ƒ: "+p(a(s).activeApiKeys||0),1)]),_:1},8,["value"]),Z(C,{icon:"fas fa-user-circle",subtitle:"",title:"æœåŠ¡è´¦æˆ·",variant:"success"},{value:E(()=>[t("div",ke,[t("span",null,p(a(s).totalAccounts),1),a(s).accountsByPlatform?(k(),b("div",_e,[a(s).accountsByPlatform.claude&&a(s).accountsByPlatform.claude.total>0?(k(),b("div",{key:0,class:"inline-flex items-center gap-0.5",title:`Claude: ${a(s).accountsByPlatform.claude.total} ä¸ª (æ­£å¸¸: ${a(s).accountsByPlatform.claude.normal})`},[e[7]||(e[7]=t("i",{class:"fas fa-brain text-xs text-primary-600"},null,-1)),t("span",Ce,p(a(s).accountsByPlatform.claude.total),1)],8,we)):A("",!0),a(s).accountsByPlatform["claude-console"]&&a(s).accountsByPlatform["claude-console"].total>0?(k(),b("div",{key:1,class:"inline-flex items-center gap-0.5",title:`Console: ${a(s).accountsByPlatform["claude-console"].total} ä¸ª (æ­£å¸¸: ${a(s).accountsByPlatform["claude-console"].normal})`},[e[8]||(e[8]=t("i",{class:"fas fa-terminal text-xs text-secondary-600"},null,-1)),t("span",Te,p(a(s).accountsByPlatform["claude-console"].total),1)],8,De)):A("",!0),a(s).accountsByPlatform.gemini&&a(s).accountsByPlatform.gemini.total>0?(k(),b("div",{key:2,class:"inline-flex items-center gap-0.5",title:`Gemini: ${a(s).accountsByPlatform.gemini.total} ä¸ª (æ­£å¸¸: ${a(s).accountsByPlatform.gemini.normal})`},[e[9]||(e[9]=t("i",{class:"fas fa-robot text-xs text-yellow-600"},null,-1)),t("span",Se,p(a(s).accountsByPlatform.gemini.total),1)],8,$e)):A("",!0),a(s).accountsByPlatform.bedrock&&a(s).accountsByPlatform.bedrock.total>0?(k(),b("div",{key:3,class:"inline-flex items-center gap-0.5",title:`Bedrock: ${a(s).accountsByPlatform.bedrock.total} ä¸ª (æ­£å¸¸: ${a(s).accountsByPlatform.bedrock.normal})`},[e[10]||(e[10]=t("i",{class:"fab fa-aws text-xs text-orange-600"},null,-1)),t("span",Re,p(a(s).accountsByPlatform.bedrock.total),1)],8,Ae)):A("",!0),a(s).accountsByPlatform.openai&&a(s).accountsByPlatform.openai.total>0?(k(),b("div",{key:4,class:"inline-flex items-center gap-0.5",title:`OpenAI: ${a(s).accountsByPlatform.openai.total} ä¸ª (æ­£å¸¸: ${a(s).accountsByPlatform.openai.normal})`},[e[11]||(e[11]=t("i",{class:"fas fa-openai text-xs text-gray-100"},null,-1)),t("span",Be,p(a(s).accountsByPlatform.openai.total),1)],8,Pe)):A("",!0),a(s).accountsByPlatform.azure_openai&&a(s).accountsByPlatform.azure_openai.total>0?(k(),b("div",{key:5,class:"inline-flex items-center gap-0.5",title:`Azure OpenAI: ${a(s).accountsByPlatform.azure_openai.total} ä¸ª (æ­£å¸¸: ${a(s).accountsByPlatform.azure_openai.normal})`},[e[12]||(e[12]=t("i",{class:"fab fa-microsoft text-xs text-primary-600"},null,-1)),t("span",Ue,p(a(s).accountsByPlatform.azure_openai.total),1)],8,Ie)):A("",!0),a(s).accountsByPlatform["openai-responses"]&&a(s).accountsByPlatform["openai-responses"].total>0?(k(),b("div",{key:6,class:"inline-flex items-center gap-0.5",title:`OpenAI Responses: ${a(s).accountsByPlatform["openai-responses"].total} ä¸ª (æ­£å¸¸: ${a(s).accountsByPlatform["openai-responses"].normal})`},[e[13]||(e[13]=t("i",{class:"fas fa-server text-xs text-cyan-600"},null,-1)),t("span",Fe,p(a(s).accountsByPlatform["openai-responses"].total),1)],8,Me)):A("",!0)])):A("",!0)])]),subtitle:E(()=>[t("span",null,"æ­£å¸¸: "+p(a(s).normalAccounts||0),1),a(s).abnormalAccounts>0?(k(),b("span",Ke," | å¼‚å¸¸: "+p(a(s).abnormalAccounts),1)):A("",!0),a(s).pausedAccounts>0?(k(),b("span",Oe," | åœæ­¢è°ƒåº¦: "+p(a(s).pausedAccounts),1)):A("",!0),a(s).rateLimitedAccounts>0?(k(),b("span",Le," | é™æµ: "+p(a(s).rateLimitedAccounts),1)):A("",!0)]),_:1}),Z(C,{icon:"fas fa-chart-line",subtitle:"",title:"ä»Šæ—¥è¯·æ±‚",value:a(s).todayRequests,variant:"magenta"},{subtitle:E(()=>[P("æ€»è¯·æ±‚: "+p(D(a(s).totalRequests||0)),1)]),_:1},8,["value"]),Z(C,{icon:"fas fa-heartbeat",subtitle:"",title:"ç³»ç»ŸçŠ¶æ€",variant:"warning"},{value:E(()=>[t("span",Ee,p(a(s).systemStatus),1)]),subtitle:E(()=>[P("è¿è¡Œæ—¶é—´: "+p(a(yt)),1)]),_:1})]),t("div",qe,[t("div",ze,[t("div",Ge,[t("div",null,[e[14]||(e[14]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," è´¦æˆ·ä½™é¢/é…é¢ ",-1)),t("p",He,p(d(ct.value.totalBalance||0)),1),t("p",Ne," ä½ä½™é¢: "+p(ct.value.lowBalanceCount||0)+" | æ€»æˆæœ¬: "+p(d(ct.value.totalCost||0)),1)]),e[15]||(e[15]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-emerald-500 to-green-600"},[t("i",{class:"fas fa-wallet"})],-1))]),t("div",Ve,[t("p",je," æ›´æ–°æ—¶é—´: "+p(x(Mt.value)),1),t("button",{class:"flex items-center gap-2 rounded-lg border border-gray-200 bg-white px-3 py-1.5 text-xs font-medium text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:border-gray-500",disabled:V.value,onClick:m},[t("i",{class:Y(["fas",V.value?"fa-spinner fa-spin":"fa-sync-alt"])},null,2),e[16]||(e[16]=P(" åˆ·æ–° ",-1))],8,Ye)])]),t("div",We,[t("div",Ze,[e[17]||(e[17]=t("h3",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"ä½ä½™é¢è´¦æˆ·",-1)),t("span",Je,p(At.value.length)+" ä¸ª ",1)]),V.value?(k(),b("div",Qe," æ­£åœ¨åŠ è½½... ")):At.value.length===0?(k(),b("div",Xe," å…¨éƒ¨æ­£å¸¸ ")):(k(),b("div",ta,[(k(!0),b(Kt,null,Ot(At.value,f=>{var I;return k(),b("div",{key:f.accountId,class:"rounded-lg border border-red-200 bg-red-50 p-3 dark:border-red-900/60 dark:bg-red-900/20"},[t("div",ea,[t("div",aa,p(f.name||f.accountId),1),t("span",sa,p(St(f.platform)),1)]),t("div",oa,[f.balance?(k(),b("span",na,"ä½™é¢: "+p(f.balance.formattedAmount),1)):(k(),b("span",ra,"ä»Šæ—¥æˆæœ¬: "+p(d(((I=f.statistics)==null?void 0:I.dailyCost)||0)),1))]),f.quota&&typeof f.quota.percentage=="number"?(k(),b("div",la,[t("div",ia,[e[18]||(e[18]=t("span",null,"é…é¢ä½¿ç”¨",-1)),t("span",da,p(f.quota.percentage.toFixed(1))+"% ",1)]),t("div",ca,[t("div",{class:"h-2 rounded-full bg-red-500",style:de({width:`${Math.min(100,f.quota.percentage)}%`})},null,4)])])):A("",!0)])}),128))]))])]),t("div",ua,[Z(C,{icon:"fas fa-coins",subtitle:"",title:"ä»Šæ—¥Token",variant:"secondary"},{value:E(()=>[t("div",ma,[t("span",null,p(D((a(s).todayInputTokens||0)+(a(s).todayOutputTokens||0)+(a(s).todayCacheCreateTokens||0)+(a(s).todayCacheReadTokens||0))),1),t("span",pa," / "+p(a(pt).todayCosts.formatted.totalCost),1)])]),default:E(()=>[t("div",ya,[t("div",ga,[t("span",null,[e[19]||(e[19]=P(" è¾“å…¥: ",-1)),t("span",fa,p(D(a(s).todayInputTokens||0)),1)]),t("span",null,[e[20]||(e[20]=P(" è¾“å‡º: ",-1)),t("span",xa,p(D(a(s).todayOutputTokens||0)),1)]),(a(s).todayCacheCreateTokens||0)>0?(k(),b("span",va,[e[21]||(e[21]=P(" ç¼“å­˜åˆ›å»º: ",-1)),t("span",ha,p(D(a(s).todayCacheCreateTokens||0)),1)])):A("",!0),(a(s).todayCacheReadTokens||0)>0?(k(),b("span",ba,[e[22]||(e[22]=P(" ç¼“å­˜è¯»å–: ",-1)),t("span",ka,p(D(a(s).todayCacheReadTokens||0)),1)])):A("",!0)])])]),_:1}),Z(C,{icon:"fas fa-database",subtitle:"",title:"æ€»Tokenæ¶ˆè€—",variant:"success"},{value:E(()=>[t("div",_a,[t("span",wa,p(D((a(s).totalInputTokens||0)+(a(s).totalOutputTokens||0)+(a(s).totalCacheCreateTokens||0)+(a(s).totalCacheReadTokens||0))),1),t("span",Ca," / "+p(a(pt).totalCosts.formatted.totalCost),1)])]),default:E(()=>[t("div",Da,[t("div",Ta,[t("span",null,[e[23]||(e[23]=P(" è¾“å…¥: ",-1)),t("span",$a,p(D(a(s).totalInputTokens||0)),1)]),t("span",null,[e[24]||(e[24]=P(" è¾“å‡º: ",-1)),t("span",Sa,p(D(a(s).totalOutputTokens||0)),1)]),(a(s).totalCacheCreateTokens||0)>0?(k(),b("span",Aa,[e[25]||(e[25]=P(" ç¼“å­˜åˆ›å»º: ",-1)),t("span",Ra,p(D(a(s).totalCacheCreateTokens||0)),1)])):A("",!0),(a(s).totalCacheReadTokens||0)>0?(k(),b("span",Pa,[e[26]||(e[26]=P(" ç¼“å­˜è¯»å–: ",-1)),t("span",Ba,p(D(a(s).totalCacheReadTokens||0)),1)])):A("",!0)])])]),_:1}),Z(C,{icon:"fas fa-tachometer-alt",subtitle:"",title:`å®æ—¶RPM (${a(s).metricsWindow}åˆ†é’Ÿ)`,variant:"warning"},{value:E(()=>[t("span",Ia,p(a(s).realtimeRPM||0),1)]),subtitle:E(()=>[e[28]||(e[28]=t("span",null,"æ¯åˆ†é’Ÿè¯·æ±‚æ•°",-1)),a(s).isHistoricalMetrics?(k(),b("span",Ua,e[27]||(e[27]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),P(" å†å²æ•°æ® ",-1)]))):A("",!0)]),_:1},8,["title"]),Z(C,{icon:"fas fa-rocket",subtitle:"",title:`å®æ—¶TPM (${a(s).metricsWindow}åˆ†é’Ÿ)`,variant:"danger"},{value:E(()=>[t("span",Ma,p(D(a(s).realtimeTPM||0)),1)]),subtitle:E(()=>[e[30]||(e[30]=t("span",null,"æ¯åˆ†é’ŸTokenæ•°",-1)),a(s).isHistoricalMetrics?(k(),b("span",Fa,e[29]||(e[29]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),P(" å†å²æ•°æ® ",-1)]))):A("",!0)]),_:1},8,["title"])]),t("div",Ka,[t("div",Oa,[e[37]||(e[37]=t("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"}," æ¨¡å‹ä½¿ç”¨åˆ†å¸ƒä¸Tokenä½¿ç”¨è¶‹åŠ¿ ",-1)),t("div",La,[t("div",Ea,[(k(!0),b(Kt,null,Ot(a(at).presetOptions,f=>(k(),b("button",{key:f.value,class:Y(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(at).preset===f.value&&a(at).type==="preset"?"bg-white text-primary-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:I=>a(o)(f.value)},p(f.label),11,qa))),128))]),t("div",za,[t("button",{class:Y(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(Q)==="day"?"bg-white text-primary-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[0]||(e[0]=f=>a(Dt)("day"))},e[31]||(e[31]=[t("i",{class:"fas fa-calendar-day mr-1"},null,-1),P("æŒ‰å¤© ",-1)]),2),t("button",{class:Y(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(Q)==="hour"?"bg-white text-primary-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[1]||(e[1]=f=>a(Dt)("hour"))},e[32]||(e[32]=[t("i",{class:"fas fa-clock mr-1"},null,-1),P("æŒ‰å°æ—¶ ",-1)]),2)]),t("div",Ga,[Z(G,{modelValue:a(at).customRange,"onUpdate:modelValue":e[2]||(e[2]=f=>a(at).customRange=f),class:"custom-date-picker w-full lg:w-auto","default-time":a(Ut),"disabled-date":a(Ht),"end-placeholder":"ç»“æŸæ—¥æœŸ",format:"YYYY-MM-DD HH:mm:ss","range-separator":"è‡³",size:"default","start-placeholder":"å¼€å§‹æ—¥æœŸ",style:{"max-width":"400px"},type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss",onChange:a(F)},null,8,["modelValue","default-time","disabled-date","onChange"]),a(Q)==="hour"?(k(),b("span",Ha,e[33]||(e[33]=[t("i",{class:"fas fa-info-circle"},null,-1),P(" æœ€å¤š24å°æ—¶ ",-1)]))):A("",!0)]),t("div",Na,[t("div",Va,[t("label",ja,[le(t("input",{"onUpdate:modelValue":e[3]||(e[3]=f=>r.value=f),class:"peer sr-only",type:"checkbox"},null,512),[[ie,r.value]]),e[36]||(e[36]=t("div",{class:"peer relative h-5 w-9 rounded-full bg-gray-300 transition-all duration-200 after:absolute after:left-[2px] after:top-0.5 after:h-4 after:w-4 after:rounded-full after:bg-white after:shadow-sm after:transition-transform after:duration-200 after:content-[''] peer-checked:bg-primary-500 peer-checked:after:translate-x-4 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary-300 dark:bg-gray-600 dark:after:bg-gray-300 dark:peer-focus:ring-primary-600"},null,-1)),t("span",Ya,[e[34]||(e[34]=t("i",{class:"fas fa-redo-alt text-xs text-gray-500 dark:text-gray-400"},null,-1)),e[35]||(e[35]=t("span",null,"è‡ªåŠ¨åˆ·æ–°",-1)),r.value?(k(),b("span",{key:0,class:Y(["ml-1 font-mono text-xs text-primary-600 transition-opacity",l.value>0?"opacity-100":"opacity-0"])},p(l.value)+"s ",3)):A("",!0)])])]),t("button",{class:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-3 py-1 text-sm font-medium text-primary-600 shadow-sm transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 sm:gap-2",disabled:y.value,title:"ç«‹å³åˆ·æ–°æ•°æ®",onClick:e[4]||(e[4]=f=>Nt())},[t("i",{class:Y(["fas fa-sync-alt text-xs",{"animate-spin":y.value}])},null,2),t("span",Za,p(y.value?"åˆ·æ–°ä¸­":"åˆ·æ–°"),1)],8,Wa)])])]),t("div",Ja,[t("div",Qa,[e[38]||(e[38]=t("h4",{class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"}," Tokenä½¿ç”¨åˆ†å¸ƒ ",-1)),t("div",Xa,[t("canvas",{ref_key:"modelUsageChart",ref:_},null,512)])]),t("div",ts,[e[41]||(e[41]=t("h4",{class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"}," è¯¦ç»†ç»Ÿè®¡æ•°æ® ",-1)),a(et).length===0?(k(),b("div",es,e[39]||(e[39]=[t("p",{class:"text-sm text-gray-500 sm:text-base"},"æš‚æ— æ¨¡å‹ä½¿ç”¨æ•°æ®",-1)]))):(k(),b("div",as,[t("table",ss,[e[40]||(e[40]=t("thead",{class:"sticky top-0 bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," æ¨¡å‹ "),t("th",{class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"}," è¯·æ±‚æ•° "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," æ€»Token "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," è´¹ç”¨ "),t("th",{class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"}," å æ¯” ")])],-1)),t("tbody",os,[(k(!0),b(Kt,null,Ot(a(et),f=>(k(),b("tr",{key:f.model,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",ns,[t("span",{class:"block max-w-[100px] truncate sm:max-w-none",title:f.model},p(f.model),9,rs)]),t("td",ls,p(D(f.requests)),1),t("td",is,p(D(f.allTokens)),1),t("td",ds,p(f.formatted?f.formatted.total:"$0.000000"),1),t("td",cs,[Z(K,{variant:"primary"},{default:E(()=>[P(p(ft(f.allTokens,a(et)))+"% ",1)]),_:2},1024)])]))),128))])])]))])])]),t("div",us,[t("div",ms,[t("div",ps,[t("canvas",{ref_key:"usageTrendChart",ref:st},null,512)])])]),t("div",ys,[t("div",gs,[t("div",fs,[e[44]||(e[44]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"}," API Keys ä½¿ç”¨è¶‹åŠ¿ ",-1)),t("div",xs,[t("button",{class:Y(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(H)==="requests"?"bg-white text-primary-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[5]||(e[5]=f=>(H.value="requests",Ft()))},e[42]||(e[42]=[t("i",{class:"fas fa-exchange-alt mr-1"},null,-1),t("span",{class:"hidden sm:inline"},"è¯·æ±‚æ¬¡æ•°",-1),t("span",{class:"sm:hidden"},"è¯·æ±‚",-1)]),2),t("button",{class:Y(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(H)==="tokens"?"bg-white text-primary-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[6]||(e[6]=f=>(H.value="tokens",Ft()))},e[43]||(e[43]=[t("i",{class:"fas fa-coins mr-1"},null,-1),t("span",{class:"hidden sm:inline"},"Token æ•°é‡",-1),t("span",{class:"sm:hidden"},"Token",-1)]),2)])]),t("div",vs,[a(O).totalApiKeys>10?(k(),b("span",hs," å…± "+p(a(O).totalApiKeys)+" ä¸ª API Keyï¼Œæ˜¾ç¤ºä½¿ç”¨é‡å‰ 10 ä¸ª ",1)):(k(),b("span",bs," å…± "+p(a(O).totalApiKeys)+" ä¸ª API Key ",1))]),t("div",ks,[t("canvas",{ref_key:"apiKeysUsageTrendChart",ref:W},null,512)])])]),t("div",_s,[t("div",ws,[t("div",Cs,[t("div",Ds,[e[45]||(e[45]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"}," è´¦å·ä½¿ç”¨è¶‹åŠ¿ ",-1)),t("span",Ts," å½“å‰åˆ†ç»„ï¼š"+p(a(M).groupLabel||"æœªé€‰æ‹©"),1)]),t("div",$s,[t("div",Ss,[(k(),b(Kt,null,Ot(dt,f=>t("button",{key:f.value,class:Y(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(wt)===f.value?"bg-white text-primary-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:I=>Qt(f.value)},p(f.label),11,As)),64))])])]),t("div",Rs,[t("span",null,"å…± "+p(a(M).totalAccounts||0)+" ä¸ªè´¦å·",1),a(M).topAccounts&&a(M).topAccounts.length?(k(),b("span",Ps," æ˜¾ç¤ºæ¶ˆè€—æ’åå‰ "+p(a(M).topAccounts.length)+" ä¸ªè´¦å· ",1)):A("",!0)]),!a(M).data||a(M).data.length===0?(k(),b("div",Bs," æš‚æ— è´¦å·ä½¿ç”¨æ•°æ® ")):(k(),b("div",Is,[t("canvas",{ref_key:"accountUsageTrendChart",ref:Tt},null,512)]))])])])}}},qs=Jt(Us,[["__scopeId","data-v-44a01bd9"]]);export{qs as default};
